VaultLicenseExpiration=function(){var e,i,s,a,t,n,r,o,p=function(){switch(i){case Constants.USER_ENTERPRISE_ADMIN:d(n)?(E("dismissedEnterpriseExpired"),"trial"===t?dialogs.vaultTierExpiredDialog.open({dialogId:"EnterpriseTrialExpired",paymentPage:bg.openEnterprisePaymentPage,storageItem:"dismissedEnterpriseExpired"}):dialogs.vaultTierExpiredDialog.open({dialogId:"EnterpriseLicenseExpired",paymentPage:bg.openEnterprisePaymentPage,storageItem:"dismissedEnterpriseExpired"})):"normal"===t&&l(n)&&1!==r?g("Your LastPass Enterprise license expires in %1 days.",n,bg.openEnterprisePaymentPage,"dismissedEnterpriseExpiring"):"trial"===t&&l(n)&&g("Your LastPass Enterprise trial expires in %1 days.",n,bg.openEnterprisePaymentPage,"dismissedEnterpriseExpiring");break;case Constants.USER_TEAMS_ADMIN:d(n)?(E("dismissedTeamsExpired"),"trial"===t?dialogs.vaultTierExpiredDialog.open({dialogId:"TeamsTrialExpired",paymentPage:bg.openTeamsPaymentPage,storageItem:"dismissedTeamsExpired"}):dialogs.vaultTierExpiredDialog.open({dialogId:"TeamsLicenseExpired",paymentPage:bg.openTeamsPaymentPage,storageItem:"dismissedTeamsExpired"})):"normal"===t&&l(n)&&1!==r?g("Your LastPass Teams license expires in %1 days.",n,bg.openTeamsPaymentPage,"dismissedTeamsExpiring"):"trial"===t&&l(n)&&g("Your LastPass Teams trial expires in %1 days.",n,bg.openTeamsPaymentPage,"dismissedTeamsExpiring");break;case Constants.USER_FAMILY_ADMIN:d(n)?(E("dismissedFamiliesExpired"),"trial"===t?dialogs.vaultTierExpiredDialog.open({dialogId:"FamiliesTrialExpired",paymentPage:bg.openFamiliesPaymentPage,storageItem:"dismissedFamiliesExpired"}):dialogs.vaultTierExpiredDialog.open({dialogId:"FamiliesLicenseExpired",paymentPage:bg.openFamiliesPaymentPage,storageItem:"dismissedFamiliesExpired"})):"normal"===t&&l(n)&&1!==r?g("Your LastPass Families license expires in %1 days.",n,bg.openFamiliesPaymentPage,"dismissedFamiliesExpiring"):"trial"===t&&l(n)&&g("Your LastPass Families trial expires in %1 days.",n,bg.openFamiliesPaymentPage,"dismissedFamiliesExpiring");break;case Constants.USER_PREMIUM_TRIAL:l(a)&&g("Your LastPass Premium trial expires in %1 days.",a,bg.openPremiumPaymentPage,"dismissedPremiumTrialExpiring");break;case Constants.USER_FREE:"trial"===t&&m(_premiumTrialExpirationDays)&&dialogs.vaultTierExpiredDialog.open({dialogId:"PremiumTrialExpired",paymentPage:bg.openPremiumPaymentPage,storageItem:"dismissedPremiumTrialExpired"})}},l=function(e){return void 0!==e&&e<=7&&e>=1},d=function(e){return void 0!==e&&e<1},m=function(e){return void 0!==e&&e<1&&e>-31},g=function(e,i,s,a){E(a),dialogs.vaultInfoBanner.open({title:Strings.translateString(e,i),dialogClass:"banner",segmentEvents:{show:{name:"license_expiration_seen"},upgrade:{name:"license_expiration_upgrade"},learn:{name:"license_expiration_learn_more"},close:{name:"license_expiration_dismiss"}},buttons:[{style:"btn-link",sizeStyle:"col-1 btn-container-sm",text:Strings.translateString("Learn More"),action:function(){bg.openPricingPage()},closeOnClick:!0,segment:"learn"},{style:"btn-gray",sizeStyle:"col-2 btn-container-lg",text:Strings.translateString("Upgrade"),action:function(){s()},closeOnClick:!0,segment:"upgrade"}]})},E=function(e){var i=JSON.parse(sessionStorage.getItem("expirationData"));null===i&&(i={}),i[e]=1,sessionStorage.setItem("expirationData",JSON.stringify(i))},u=function(e,i,s){var a=JSON.parse(sessionStorage.getItem("expirationData"));return null!==a&&(1===a[e]||1===a[i]||1===a[s])},c=function(e,i,s){var a=JSON.parse(localStorage.getItem("expiredData"));return null!==a&&(1===a[e]||1===a[i]||1===a[s])},x,P,y,S,T,I;return{initialize:function(){e=bg.get("LPContentScriptFeatures").license_expiration,i=LPProxy.getAccountClass(),s=!!bg.get("g_hasplugin"),(Constants.USER_PREMIUM_TRIAL||Constants.USER_PREMIUM_TRIAL)&&(a=bg.get("g_premium_trial_exp_days"))},setLicenseStatus:function(e,i,s){t=e,n=i,r=s},removeStoredLocalStoreExpPrefs:function(e){var i;e>360&&(null!==JSON.parse(localStorage.getItem("expiredData"))&&localStorage.removeItem("expiredData"))},showExpirationMessage:p,premiumTrialStatusChecker:function(){return e&&!s&&i===Constants.USER_PREMIUM_TRIAL&&l(a)&&!u("dismissedPremiumTrialExpiring")||i===Constants.USER_FREE&&m(a)&&!u("dismissedPremiumTrialExpired")},companyLicenseStatusChecker:function(){var a=e&&!s&&(i===Constants.USER_FAMILY_ADMIN||i===Constants.USER_ENTERPRISE_ADMIN||i===Constants.USER_TEAMS_ADMIN);return a&&bg.BackgroundServer.licensing.getCompanyLicensing(function(e){!1!==e.success||VaultLicenseExpiration.hasDismissedEnterpriseExpiredNotification()?e.hasOwnProperty("daysleft")&&!VaultLicenseExpiration.hasDismissedEnterpriseExpiringNotification()?(VaultLicenseExpiration.removeStoredLocalStoreExpPrefs(e.daysleft),VaultLicenseExpiration.setLicenseStatus("normal",e.daysleft,e.hasOwnProperty("renewalstatus")?e.renewalstatus:-1),VaultLicenseExpiration.showExpirationMessage()):e.hasOwnProperty("trialdaysleft")&&!VaultLicenseExpiration.hasDismissedEnterpriseExpiringNotification()&&(VaultLicenseExpiration.setLicenseStatus("trial",e.trialdaysleft,-1),VaultLicenseExpiration.showExpirationMessage()):(VaultLicenseExpiration.setLicenseStatus("TrialExpired"===e.code?"trial":"normal",0,-1),VaultLicenseExpiration.showExpirationMessage())}),a},hasDismissedEnterpriseExpiringNotification:function(){return u("dismissedEnterpriseExpiring","dismissedTeamsExpiring","dismissedFamiliesExpiring")},hasDismissedEnterpriseExpiredNotification:function(){return c("dismissedEnterpriseExpired","dismissedTeamsExpired","dismissedFamiliesExpired")}}}();
//# sourceMappingURL=sourcemaps/vaultLicenseExpiration.js.map
